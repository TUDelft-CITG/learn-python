

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Python Notebook #6 &#8212; Learn Python for Civil Engineering and Geosciences</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyterlite_sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/jupyterlite_sphinx.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'originals/PythonNotebook6';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installations (MUDE)" href="installations.html" />
    <link rel="prev" title="Python Notebook #5" href="PythonNotebook5.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/learn-python-logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/learn-python-logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    UNDER CONSTRUCTION
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Course</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Theory_intro.html">Introduction to the Course</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/Theory/01.html">1. Variables, operators and functions.</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/Exercises/01.html">Variables, operators and functions Exercises.</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02/Theory/01.html">2. Modules, conditions, data structures and loops</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02/Exercises/01.html">Modules, conditions, data structures and loops Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/Theory/01.html">3. Advanced strings and functions.</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/Exercises/01.html">Advanced strings and functions. Files and debugging Exercises.</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/Theory/01.html">4. Objects and References</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/Exercises/01.html">Objects and References Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05/Theory/01.html">5. Numpy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05/Exercises/01.html">Airplane velocity</a></li>


<li class="toctree-l2"><a class="reference internal" href="../05/Exercises/02.html">Maximum bending moment on a simply supported bridge</a></li>


</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/Theory/01.html">6. Pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/Exercises/01.html">Pandas Exercises</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07/Theory/01.html">7. Matplotlib</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../07/Exercises/01.html">Matplotlib Exercises</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">In a Nutshell</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../In_a_nutshell_intro.html">Python Course in a nutshell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01/In_a_Nutshell/01.html">1. Variables, operators and functions.</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Old Stuff</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="overview.html">Original Material</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="PythonNotebook1.html">Python Notebook #1</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonNotebook2.html">Python Notebook #2</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonNotebook3.html">Python Notebook #3</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonNotebook4.html">Python Notebook #4</a></li>
<li class="toctree-l2"><a class="reference internal" href="PythonNotebook5.html">Python Notebook #5</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Python Notebook #6</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installations.html">Installations (MUDE)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mude/overview.html">MUDE Materials</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="mude/1-1-student.html">Computations using Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="mude/1-1-solution.html">Computations using Numpy: Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="mude/1-2-student.html">Python data analysis with Pandas (and Matplotlib)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mude/1-2-solution.html">Python data analysis with Pandas (and Matplotlib): Solutions</a></li>
<li class="toctree-l2"><a class="reference internal" href="mude/1-2-Golden_Rules.html">Golden Rules</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Foriginals/PythonNotebook6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/originals/PythonNotebook6.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Python Notebook #6</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <figure>
  <IMG SRC="https://raw.githubusercontent.com/mbakker7/exploratory_computing_with_python/master/tudelft_logo.png" WIDTH=250 ALIGN="right"></IMG>
</figure>
<section class="tex2jax_ignore mathjax_ignore" id="python-notebook-6">
<h1>Python Notebook #6<a class="headerlink" href="#python-notebook-6" title="Permalink to this headline">#</a></h1>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<ul>
    <li> <a href="#6.1">6.1 pandas</a><br>
     <li>   <a href = '#series'>6.2 Series</a><br>
     <li>   <a href='#dataframes'>6.3 DataFrame</a><br>
     <li>   <a href='#importing'>6.4 Importing data into DataFrames and exploring its attributes</a><br>
      <li>  <a href='#statistics'>6.5 Statistics with pandas</a>
</ul><div id="6.1"></div><br><h2>6.1 <code>pandas</code></h2><br><div style="text-align: justify">With the standard Python functions and the <b><code>numpy</code></b> library, you already have access to powerful tools to process data. However, you'll find that organizing data using them might still be confusing and messy... so let us introduce you to <b><code>pandas</code></b>: a Python library specialized in data organization. Its functions are simple to use, and they achieve a lot. Furthermore, <b><code>pandas</code></b> was built on top of the <b><code>numpy</code></b> library, using some of their functions and data structures. This makes <b><code>pandas</code></b> fast. The <b><code>pandas</code></b> library is often used in Data Science and Machine Learning to organize data that are used as input in other functions, of other libraries. For example, you store and organize an Excel file using <b><code>pandas</code></b> data structures, apply statistical analysis using <b><code>SciPy</code></b>, and then plot the result using <b><code>matplotlib</code></b>.<br><br> In this section, we'll introduce you to the basic <b><code>pandas</code></b> data structures: the <b><code>Series</code></b> and <b><code>DataFrame</code></b> objects; and how to store data in them. In <b><code>pandas</code></b>, a <b><code>Series</code></b> represents a list, and <b><code>DataFrame</code></b> represents a table.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># as always, let&#39;s import some libraries</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># we&#39;ll use numpy only for comparison</span>
</pre></div>
</div>
</div>
</div>
<div id="series"></div><br><h3>6.2 <code>Series</code></h3><br><div style="text-align: justify">We start with <b><code>pandas Series</code></b>, since a <b><code>DataFrame</code></b> is made out of <b><code>Series</code></b>; retrieving a row or a column from a <b><code>DataFrame</code></b> results in a <b><code>Series</code></b>. A <b><code>Series</code></b> object is a <b><code>numpy</code></b> ndarray used to hold one-dimensional data, like a list.  We create a <b><code>Series</code></b> object using its constructor <b><code>pd.Series()</code></b>. It can be called by using a list that you want to convert into a <b><code>pandas series</code></b>. Unlike <b><code>numpy</code></b> arrays, a <b><code>Series</code></b> may hold data of different types.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a list containing elements of various types:</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;begin&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">]</span>

<span class="c1"># Construct a Series and a numpy.array using our list:</span>
<span class="n">my_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">my_list</span><span class="p">)</span>
<span class="n">my_nparray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>

<span class="c1"># Compare the type of each element in my_series and my_nparray</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">my_list</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----type of each element----&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;my_series element #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> =&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_series</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;my_nparray element #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> =&gt; </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">my_nparray</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">As expected, the <b><code>numpy</code></b> array changed all elements to one type; in this case, strings. As mentioned in Section 5.1, in Notebook 5, a <b><code>numpy</code></b> array cannot hold data of different types.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that a pandas series is, by default, printed more elaborately </span>
<span class="c1"># showing each element&#39;s index</span>

<span class="nb">print</span><span class="p">(</span><span class="n">my_series</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-----------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_nparray</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The values of a series can be accessed and sliced using the <strong><code class="docutils literal notranslate"><span class="pre">iloc()</span></code></strong> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">my_series</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<h4>Labeling <code>Series</code></h4><br><div style="text-align: justify">So far we have referred to values within a list or array using indexing, but that might be confusing. With <b><code>pandas Series</code></b>, you can refer to your values by labeling their indices. Labels allow you to access the values in a more informative way, similar to dictionaries; depicted in Section 2.3, in Notebook 2.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the indices of the same size as the list </span>
<span class="c1"># we want to construct our Series object with.</span>

<span class="n">my_index_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;My first entry&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span><span class="s2">&quot;END&quot;</span><span class="p">]</span>

<span class="c1"># Use the index option in the Series constructor</span>
<span class="n">my_labeled_Series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">my_list</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">my_index_labels</span><span class="p">)</span>

<span class="c1"># Note that our entries can be called both ways</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_labeled_Series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">my_labeled_Series</span><span class="p">[</span><span class="s2">&quot;My first entry&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify"><b><code>pandas</code></b> can automatically create labels of indices if we construct a <b><code>Series</code></b> using a dictionary with labeled entries.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_dictionary</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;a list&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">420</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span><span class="s2">&quot;a float&quot;</span><span class="p">:</span> <span class="mi">380</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;a list of strings&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;first word&quot;</span><span class="p">,</span> <span class="s2">&quot;Second Word&quot;</span><span class="p">,</span> <span class="s2">&quot;3rd w0rd&quot;</span><span class="p">]</span> <span class="p">}</span>
<span class="n">my_Series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">my_dictionary</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">my_Series</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can access an element within the list labeled &quot;a list of strings&quot; </span>
<span class="c1"># by using its label followed by the desired index</span>

<span class="n">my_Series</span><span class="p">[</span><span class="s2">&quot;a list of strings&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"><b>Exercise 6.2.1</b><br><br><div style="text-align: justify">Finish a function, which with a <code>for</code> loop will get all types saved in series <code>my_series</code>.</div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;write your code here&#39;&#39;&#39;</span>

<span class="k">def</span> <span class="nf">list_types</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">series_types</span> <span class="o">=</span> <span class="s2">&quot;Types inside series:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="o">...</span>
        <span class="n">item_type</span> <span class="o">=</span> <span class="o">...</span>
        <span class="n">series_types</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_type</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">series_types</span>
        
<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="k">def</span> <span class="nf">list_types</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">series_types</span> <span class="o">=</span> <span class="s2">&quot;Types inside series:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)):</span>
        <span class="n">item_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">series_types</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_type</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">series_types</span>
<span class="c1">###END SOLUTION</span>

<span class="nb">print</span><span class="p">(</span><span class="n">list_types</span><span class="p">(</span><span class="n">my_series</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="k">def</span> <span class="nf">solution_6_2_1</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="n">series_types</span> <span class="o">=</span> <span class="s2">&quot;Types inside series:</span><span class="se">\n</span><span class="s2">&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)):</span>
        <span class="n">item_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">series_types</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_type</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    
    <span class="k">return</span> <span class="n">series_types</span>

<span class="k">assert</span> <span class="n">list_types</span><span class="p">(</span><span class="n">my_series</span><span class="p">)</span> <span class="o">==</span> <span class="n">solution_6_2_1</span><span class="p">(</span><span class="n">my_series</span><span class="p">),</span> <span class="s1">&#39;6.2.1 - Incorrect answer&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">Note the above exercise could have been solved without a <b><code>for</code></b> loop:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">types</span> <span class="o">=</span> <span class="n">my_series</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning"><center>When using <code>pandas</code>, it's a good idea to try and avoid <code>for</code> loops or iterative solutions; <code>pandas</code> usually has a faster solution than iterating through its elements.</center></div><div id="dataframes"></div><br><h3>6.3 <code>DataFrame</code></h3><br><div style="text-align: justify">A <b><code>DataFrame</code></b> is a data structure used to represent two-dimensional data. A common example of data organized in two dimensions are tables or two-dimensional arrays.</div><h4>From <code>Series</code> to columns of a <code>DataFrame</code> table</h4><br><div style="text-align: justify">Usually, <b><code>DataFrames</code></b> are made out of <b><code>Series</code></b>. However, its constructor accepts other types.</div> <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define a few series to represent individual rows:</span>

<span class="n">row_1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Garnet&#39;</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span>   <span class="s1">&#39;Fracture&#39;</span><span class="p">,</span> <span class="mf">3.9</span>  <span class="p">])</span>
<span class="n">row_2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Graphite&#39;</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;One&#39;</span><span class="p">,</span> <span class="mf">2.3</span> <span class="p">])</span>
<span class="n">row_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Kyanite&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>    <span class="s1">&#39;One&#39;</span><span class="p">,</span> <span class="mf">4.01</span>   <span class="p">])</span>
<span class="n">row_4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="s1">&#39;bad&#39;</span><span class="p">,</span> <span class="s1">&#39;@#$%^&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;asdf&quot;</span><span class="p">])</span>
<span class="c1"># data from: https://www.researchgate.net/figure/Selected-physical-properties-of-minerals-common-to-NYC-bedrock_tbl1_228544586</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">By default, the <b><code>DataFrame</code></b> constructor creates rows with the elements of each <b><code>Series</code></b>:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create DataFrame using multiple Series as rows</span>

<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">row_1</span><span class="p">,</span> <span class="n">row_2</span><span class="p">,</span> <span class="n">row_3</span><span class="p">,</span> <span class="n">row_4</span><span class="p">])</span> 
<span class="c1"># the name &quot;df&quot; is often used as a name for a dataframe object</span>

<span class="n">df2</span>
</pre></div>
</div>
</div>
</div>
<p>We can also create a <b><code>DataFrame</code></b> using <b><code>Series</code></b> as columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define series representing columns:</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;Amphibole&#39;</span><span class="p">,</span> <span class="s1">&#39;Biotite&#39;</span><span class="p">,</span> <span class="s1">&#39;Calcite&#39;</span><span class="p">,</span> <span class="s1">&#39;Dolomite&#39;</span><span class="p">,</span> <span class="s1">&#39;Feldspars&#39;</span><span class="p">])</span>
<span class="n">hardness</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">5.5</span><span class="p">,</span> <span class="mf">2.75</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">specific_gravity</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">2.72</span><span class="p">,</span> <span class="mf">2.85</span><span class="p">,</span> <span class="mf">2.645</span><span class="p">])</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="n">j</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mf">11.00000</span><span class="p">])</span>

<span class="c1"># convert each series to a dataframe:</span>
<span class="n">col_1</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> 
<span class="n">col_2</span> <span class="o">=</span> <span class="n">hardness</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;hardness&#39;</span><span class="p">)</span>
<span class="n">col_3</span> <span class="o">=</span> <span class="n">specific_gravity</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;sp. gr.&#39;</span><span class="p">)</span>
<span class="n">col_4</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">After creating each column, we can concatenate them together into one <b><code>DataFrame</code></b> table using the <b><code>pd.concat()</code></b> function. There are two axes in a <b><code>DataFrame</code></b>: '0' (or 'index') for the rows, and '1' (or 'columns') for the columns. We want to concatenate the series along their columns, so use <b><code>axis=1</code></b> (or <b><code>axis='columns'</code></b>).</div> <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#concatenate the series into one dataframe:</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">col_1</span><span class="p">,</span> <span class="n">col_2</span><span class="p">,</span> <span class="n">col_3</span><span class="p">,</span> <span class="n">col_4</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">Alternatively, you could use the <b><code>np.transpose()</code></b> function to generate the <b><code>DataFrame</code></b> using a <b><code>Series</code></b> as columns:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># transpose</span>
<span class="n">df_T</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">name</span><span class="p">,</span><span class="n">hardness</span><span class="p">,</span><span class="n">specific_gravity</span><span class="p">,</span><span class="n">test</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># then label the columns</span>
<span class="n">df_T</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;hardness&#39;</span><span class="p">,</span> <span class="s1">&#39;sp. gr.&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">]</span>

<span class="n">df_T</span>
</pre></div>
</div>
</div>
</div>
<p>To create a new column, simply do:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;new_column&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df1</span>
</pre></div>
</div>
</div>
</div>
<h4>Labeling <code>DataFrames</code></h4><br><div style="text-align: justify">You can also rename your columns' and rows' index names by changing your DataFrame's <b><code>columns</code></b> and <b><code>index</code></b> attributes, respectively. Recall our <b><code>df2</code></b>:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s rename its columns’ and rows’ index names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># renaming columns&#39; index names</span>
<span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;hardness&#39;</span><span class="p">,</span>  <span class="s1">&#39;cleavage&#39;</span><span class="p">,</span> <span class="s1">&#39;sp. gr.&#39;</span><span class="p">,</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>

<span class="c1"># renaming rows&#39; index names</span>
<span class="n">df2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;row0&#39;</span><span class="p">,</span><span class="s1">&#39;row1&#39;</span><span class="p">,</span><span class="s1">&#39;row2&#39;</span><span class="p">,</span><span class="s1">&#39;row3&#39;</span><span class="p">]</span>

<span class="n">df2</span> <span class="c1"># calling df2 again</span>
</pre></div>
</div>
</div>
</div>
<h4>Concatenating <code>DataFrames</code></h4><br><div style="text-align: justify">We can also concatenate <b><code>DataFrames</code></b> to each other, even if they are of different sizes.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">In the resulting table, we notice that <b><code>pandas</code></b> automatically added <b><code>NaN</code></b> <i>("Not a Number")</i> values to the missing entries of either table. Very convenient!</div><div class="alert alert-block alert-info"><b>(Searching) Exercise 6.3.1</b><br><br><div style="text-align: justify">Complete the code below to print the total number of <i>'NaN'</i> values in <code>df3</code>.</div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; change only the ... below, do not add any other lines to this cell &#39;&#39;&#39;</span>

<span class="k">def</span> <span class="nf">count_nans</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">nan_total</span> <span class="o">=</span> <span class="o">...</span>
    <span class="k">return</span> <span class="n">nan_total</span>

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="k">def</span> <span class="nf">count_nans</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">nan_total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nan_total</span>
<span class="c1">###END SOLUTION</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">total amount of nans = </span><span class="si">{</span><span class="n">count_nans</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="k">assert</span> <span class="n">count_nans</span><span class="p">(</span><span class="n">df3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;6.3.1 - Incorrect answer&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<h4>Removing rows and columns</h4><br><div style="text-align: justify">Our table looks a bit messy though... let's make it better by removing the <i>'test'</i> row and column. We can drop them by using the <b><code>pd.drop()</code></b> function.  By default, the <b><code>pd.drop()</code></b> function outputs a copy of the inserted <b><code>DataFrame</code></b> without the dropped items. The original data will then be preserved if you give a new name to the dataframe (i.e., the copy) with dropped items.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of how you could use pd.drop() to remove a row or column</span>
<span class="n">new_df3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;row3&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># note that we used that row&#39;s index name</span>
<span class="n">new_df3</span> <span class="o">=</span> <span class="n">new_df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># and column&#39;s index name</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_df3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># recall that df3 is unchanged</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">In case you would like to edit the original <b><code>df3</code></b>; you would apply the drop-operation <i>'inplace'</i>. For this, we use the <b><code>inplace=True</code></b> option. To avoid dropping rows and columns with the same index name, you could use the <b><code>pd.reset_index()</code></b> function. With <b><code>drop=True</code></b>, the new <b><code>DataFrame</code></b> will have dropped the old indexes; keeping the new reset ones.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset the index to the default integer index</span>
<span class="c1"># dropping the old indexes</span>

<span class="n">df3_cleaned</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">df3_cleaned</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now let&#39;s drop row 8</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># and column &#39;test&#39; (remember to add axis=1 when dropping a column)</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">Note that if you try to re-run the above cell without re-running the previous one, you will get an error. This happens because after running the above cell once, you drop row '8' and the 'test' column from <b><code>df3_cleaned</code></b>, trying to run again will attempt to re-drop something that doesn't exist. Re-running the previous cell 'fixes' this issue since you re-assign <b><code>df3_cleaned</code></b> as <b><code>df3.reset_index(drop=True)</code></b>.</div><div class="alert alert-block alert-warning"><center>If one or more rows (or columns) have the same index name, <code>pd.drop()</code> will drop all of them.</center></div><div class="alert alert-block alert-info"><b>(Searching) Exercise 6.3.2</b><br><br><div style="text-align: justify"> Alter <code>df_632</code> as follows:<br>1) Change the index of the rows to be the column 'name';<br>2) drop the column 'name';<br>3) drop the columns 'test' and 'new_column';<br>4) drop the row named 'test';<br>5) add a new column '% of Earth's crust' with values 'TBD'.<br><br>For your easy reference, your final <code>df_632</code> should look like this:<br><br></div>
<p><img alt="image.png" src="originals/attachment:image.png" /></div></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_632</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># write your code here</span>
<span class="o">...</span>

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>

<span class="n">df_632</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_632</span><span class="o">.</span><span class="n">name</span>
<span class="n">df_632</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_632</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_632</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_632</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_632</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f Earth&#39;s crust&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TBD&#39;</span>
<span class="c1">###END SOLUTION</span>


<span class="nb">print</span><span class="p">(</span><span class="n">df_632</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="n">df_sol</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_sol</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_sol</span><span class="o">.</span><span class="n">name</span>
<span class="n">df_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_sol</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">% o</span><span class="s2">f Earth&#39;s crust&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;TBD&#39;</span>

<span class="k">assert</span> <span class="n">df_sol</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_632</span><span class="p">),</span> <span class="s1">&#39;6.3.2 - Incorrect answer.</span><span class="se">\</span>
<span class="s1">Make sure to use inplace=True and axis=1 for removing columns&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<h4>Accessing and modifying <code>DataFrame</code> values</h4><br><div style="text-align: justify">Now that we created our table, we want to be able to access and modify the individual values within it. This way we could add the missing values to the <i>'cleavage'</i> column. There are many ways to do this because <b><code>numpy</code></b> and standard Python functions are often still applicable on <b><code>pandas</code></b> data structures. However, there is a difference in processing speed. Therefore, when accessing or modifying data, try to use <b><code>pandas</code></b> functions, such as: <b><code>.iat()</code></b>, <b><code>.at()</code></b>, <b><code>.iloc()</code></b>, and <b><code>.loc()</code></b> instead of using the common <b><code>[]</code></b> square bracket syntax, as they might raise some warnings:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3_cleaned</span><span class="o">.</span><span class="n">cleavage</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;One&#39;</span> <span class="c1"># warning</span>

<span class="n">df3_cleaned</span> <span class="c1"># note that the value still changed, but avoid doing so</span>
</pre></div>
</div>
</div>
</div>
<h4><code>.iat()</code> vs <code>.at()</code> vs <code>.iloc()</code> vs <code>.loc()</code></h4><br><div style="text-align: justify">In <a href = "https://stackoverflow.com/questions/28757389/pandas-loc-vs-iloc-vs-at-vs-iat">this discussion in stackoverflow</a>, they point out some differences between these methods. To keep in mind, <b><code>.iat()</code></b> and <b><code>.at()</code></b> are the fastest ones, but they only return scalars (one element), while <b><code>.loc()</code></b> and <b><code>.iloc()</code></b> can access several elements at the same time. Lastly, <b><code>.iat()</code></b> and <b><code>.iloc</code></b> use indexes (numbers), while <b><code>.at()</code></b> and <b><code>.loc()</code></b> use labels. For more information, check the stackoverflow discussion.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># accessing values using arrays as index with .iloc()</span>
<span class="c1"># only method that allows arrays in both rows and cols</span>

<span class="n">indx_array_row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">indx_array_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indx_array_row</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">indx_array_col</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># accessing values with .loc(), only rows are allowed to be arrays</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indx_array_row</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;hardness&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># or multiple columns with .loc():</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indx_array_row</span><span class="p">[:</span><span class="mi">2</span><span class="p">],[</span><span class="s1">&#39;hardness&#39;</span><span class="p">,</span> <span class="s1">&#39;cleavage&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># accessing values with .at(), no arrays allowed, only labels</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;hardness&#39;</span><span class="p">]</span> <span class="c1"># row 0, &#39;hardness&#39; column</span>

<span class="c1"># note that using 0 will work since we do not have labels for the rows</span>
<span class="c1"># so their labels are their index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># if we were to change the index of this df to their names</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df3_cleaned</span><span class="o">.</span><span class="n">name</span>

<span class="c1"># and delete column &#39;name&#39;</span>

<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3_cleaned</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># now using df.at[0,&#39;hardness&#39;] doesn&#39;t work since there&#39;s no row</span>
<span class="c1"># with label 0</span>

<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;hardness&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># accessing values with .iat(), no arrays allowed, no labels allowed</span>
<span class="c1"># only indexes</span>
<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># in case you want to know the index number of a column or row:</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">))</span> <span class="c1"># new_column index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;Dolomite&#39;</span><span class="p">))</span> <span class="c1"># Dolomite index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># since the above lines return the index of a column and row</span>
<span class="c1"># you can use them directly with .iat()</span>

<span class="n">df3_cleaned</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">df3_cleaned</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;Dolomite&#39;</span><span class="p">),</span> <span class="n">df3_cleaned</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Selecting multiple columns:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3_cleaned</span><span class="p">[[</span><span class="s1">&#39;hardness&#39;</span><span class="p">,</span><span class="s1">&#39;new_column&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">Finally, removing a column by making a copy and re-assigning the original variable as its copy. (Alternative to <b><code>inplace=True</code></b>)</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3_cleaned</span> <span class="o">=</span> <span class="n">df3_cleaned</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;new_column&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df3_cleaned</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"><b>(Searching/Fixing) Exercise 6.3.3</b><br><br><div style="text-align: justify">A geologist wrote a line of code to know how many of the listed minerals have a hardness greater than or equal to $3$. However, something is not correct in his code... could you maybe fix it? There is a syntax error as well as a semantic error.</div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">count_minerals</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">minimal_hardness</span><span class="p">):</span>
    <span class="n">amount_of_minerals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">hardness</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">minimal_hardness</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">amount_of_minerals</span>

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="k">def</span> <span class="nf">count_minerals</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">minimal_hardness</span><span class="p">):</span>
    <span class="n">amount_of_minerals</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">hardness</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">minimal_hardness</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">amount_of_minerals</span>                           
<span class="c1">###END SOLUTION            </span>
      
<span class="nb">print</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Amount of minerals with hardness &gt;= 3: </span><span class="si">{</span><span class="n">count_minerals</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="k">assert</span> <span class="n">count_minerals</span><span class="p">(</span><span class="n">df3_cleaned</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;6.3.3 - Incorrect answer&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">The above exercise might look like a silly one, but take some time to analyze it carefully... what is happening there? Break down each part of that line of code to understand it properly.</div><div id="importing"></div><br><h3>6.4 Importing data into <code>DataFrames</code> and exploring its attributes</h3><br><div style="text-align: justify"><b><code>pandas</code></b> provides many functions to import data into <b><code>dataframes</code></b>, such as <b><code>read_csv()</code></b> to read delimited text files, or <b><code>read_excel()</code></b> for Excel or OpenDocument spreadsheets. <b><code>read_csv()</code></b> provides options that allow you to filter the data, such as specifying the separator/delimiter, the lines that form the headers, which rows to skip, etc. Let's analyze the <b><code>mineral_properties.txt</code></b>. Below a screenshot of it:<br><br></div>
<p><img alt="image.png" src="originals/attachment:image.png" /></div></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># below we import the .txt</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;../resource/lib/publicdata/&#39;</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mineral_properties.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                  <span class="n">skiprows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># we indicate that the separator is the comma &quot;sep=&#39;,&#39;&quot;</span>
<span class="c1"># we indicate the header (what should be the columns names) is in the second line &quot;header=[1]&quot;</span>
<span class="c1"># we indicate to not skip any rows &quot;skiprows=None&quot;</span>
<span class="c1"># we indicate the first column should be the index of the rows &quot;index_col=0&quot;</span>

<span class="n">df4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note that if we try to call any of the columns from df4</span>
<span class="c1"># we will get an error</span>

<span class="n">df4</span><span class="p">[</span><span class="s1">&#39;hardness&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Do you know why?</p>
<p><b>Answer</b> …</p>
<p>In case you were not able to answer the above question, let’s look into <b><code>df4.columns</code></b></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">You see there are spaces at the beginning of each column name... this happens because that's how people usually type, with commas followed by a space. We could use the <b><code>skipinitialspace = True</code></b> from the <b><code>pd.read_csv()</code></b> function to avoid this. Let's try it out:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mineral_properties.txt&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                  <span class="n">skiprows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Ok, much better!</p>
<div id="statistics"></div><br><h3>6.5 Statistics with <b><code>pandas</code></b></h3><br><div style="text-align: justify">Recall some functions such as <b><code>np.mean()</code></b> and <b><code>np.max()</code></b>; these functions can be used to calculate a row's or column's statistics. Say you want to know what's the average <i>hardness</i> of the different minerals:</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span><span class="p">[</span><span class="s1">&#39;hardness&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div style="text-align: justify">Often we don't know much about the data, and printing all the values is inconvenient. In that case, it's wise to take a look at some of its attributes first.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># see the labels of the columns and rows</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;----------------------&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df4.info is similar to print(df4.info)</span>
<span class="n">df4</span><span class="o">.</span><span class="n">info</span>
</pre></div>
</div>
</div>
</div>
<h3>Deep copying a <code>DataFrame</code></h3><br><div style="text-align: justify">As you have seen in Notebook 4, shallow copies can be troublesome if you're not aware of it. In <b><code>pandas</code></b>, it's the same story.<br><br>To make a deep copy use the <b><code>DataFrame.copy(deep=True)</code></b> function.</div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_deep</span> <span class="o">=</span> <span class="n">df4</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now, altering <b><code>df_deep</code></b> will not alter <b><code>df4</code></b>; and vice-versa.</p>
<div class="alert alert-block alert-info"><b>(Searching) Exercise 6.5.1</b><br><br><div style="text-align: justify">A geologist is interested in the tallest mountain chains around Earth. For that, he created the <code>tallest_mountains.csv</code> table, containing information on all mountains above $8000$ meters. Your task is to do the following $5$ assignments.<br><br>1) Read the <code>tallest_mountains.csv</code> file.<br>2) What are the names of the columns?<br>3) What is the height of the tallest mountain?<br>4) What is the row number (or index) of this mountain?<br>5) What is the name of the tallest mountain in the dataset?<br><br><b>Hard-coded answers won't be accepted. Use <code>pandas</code> functions to answer the questions.</b><br><br><i>Source for this and next exercises: <a href="https://en.wikipedia.org/wiki/List_of_mountains_by_elevation">Wikipedia</a></i></div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; write your code here, do not change any variable name &#39;&#39;&#39;</span>

<span class="n">df8000</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 1) read the file</span>
<span class="n">cols</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 2) name of columns</span>
<span class="n">max_height</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 3) height of tallest mountain</span>
<span class="n">indxmax</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 4) index of the row containing &#39;max_height&#39;</span>
<span class="n">tallest_mountain</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 5) name of the tallest mountain</span>

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="n">df8000</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;tallest_mountains.csv&#39;</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="n">df8000</span><span class="o">.</span><span class="n">columns</span>
<span class="n">max_height</span> <span class="o">=</span> <span class="n">df8000</span><span class="p">[</span><span class="s1">&#39;Metres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
<span class="n">indxmax</span> <span class="o">=</span> <span class="n">df8000</span><span class="p">[</span><span class="s1">&#39;Metres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span> 
<span class="n">tallest_mountain</span> <span class="o">=</span> <span class="n">df8000</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indxmax</span><span class="p">,</span><span class="s1">&#39;Mountain&#39;</span><span class="p">]</span>
<span class="c1">###END SOLUTION</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df8000</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="n">df_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;tallest_mountains.csv&#39;</span><span class="p">)</span>
<span class="n">cols_sol</span> <span class="o">=</span> <span class="n">df_sol</span><span class="o">.</span><span class="n">columns</span>
<span class="n">max_height_sol</span> <span class="o">=</span> <span class="n">df_sol</span><span class="p">[</span><span class="s1">&#39;Metres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> 
<span class="n">indxmax_sol</span> <span class="o">=</span> <span class="n">df_sol</span><span class="p">[</span><span class="s1">&#39;Metres&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span> 
<span class="n">tallest_mountain_sol</span> <span class="o">=</span> <span class="n">df_sol</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">indxmax_sol</span><span class="p">,</span><span class="s1">&#39;Mountain&#39;</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">df_sol</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df8000</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cols_sol</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span> <span class="ow">and</span> <span class="n">max_height_sol</span> <span class="o">==</span> <span class="n">max_height</span> <span class="ow">and</span> \
        <span class="n">indxmax_sol</span> <span class="o">==</span> <span class="n">indxmax</span> <span class="ow">and</span> <span class="n">tallest_mountain_sol</span> <span class="o">==</span> <span class="n">tallest_mountain</span><span class="p">,</span> \
    <span class="s1">&#39;6.5.1 - Incorrect answer, did you use idxmax for the 4th problem?&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"><b>(Searching) Exercise 6.5.2</b><br><br><div style="text-align: justify">Now, our geologist friend got another table with all mountains above $7000$ meters, it's in the <code>mountains_above_7000m_copy.csv</code> file. Your task is to do the following $6$ assignments.<br><br>1) Read the <code>mountains_above_7000m_copy.csv</code> file.<br>2) Remove the column describing the mountain range they belong.<br>3) Append <code>df8000</code> to this.<br>4) Fix the row-indexing issue.<br>5) Create a <code>Series</code> indicating which entries of 'Feet' are missing.<br><i>Hint: Use the <code>.isnull()</code> function</i><br>6) Add the values that are missing in the 'Feet' column, use $1$ mtr = $3.28084$ feet.<br><i>Hint2: Use the <code>.mask()</code> function, more info <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mask.html">here</a>, or the <code>.fillna()</code> function.</i></div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; write your code here, do not change any variable name &#39;&#39;&#39;</span>

<span class="n">df7000</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 1</span>
<span class="n">df7000_norange</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 2</span>
<span class="n">df_concat</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 3</span>

<span class="c1">#check what you have now</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_concat</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; write the rest of your code here, do not change any variable name &#39;&#39;&#39;</span>

<span class="n">df_reset</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 4</span>
<span class="n">missing_feet_series</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 5</span>
<span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span> <span class="c1"># 6</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_reset</span><span class="p">)</span> 

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="n">df7000</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mountains_above_7000m_copy.csv&#39;</span><span class="p">,</span> <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># 1</span>
<span class="n">df7000_norange</span> <span class="o">=</span> <span class="n">df7000</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Range&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 2</span>
<span class="n">df_concat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df7000_norange</span><span class="p">,</span><span class="n">df8000</span><span class="p">])</span> <span class="c1"># 3</span>
<span class="n">df_reset</span> <span class="o">=</span> <span class="n">df_concat</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="n">missing_feet_series</span> <span class="o">=</span> <span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># 5</span>
<span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">missing_feet_series</span><span class="p">,</span> <span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Metres&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">3.28084</span><span class="p">)</span> <span class="c1"># 6</span>
<span class="c1">###END SOLUTION</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="n">df_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;tallest_mountains.csv&#39;</span><span class="p">)</span>

<span class="n">df7000_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mountains_above_7000m_copy.csv&#39;</span><span class="p">,</span> <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># 1</span>
<span class="n">df7000_norange_sol</span> <span class="o">=</span> <span class="n">df7000_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Range&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 2</span>
<span class="n">df_concat_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df7000_norange_sol</span><span class="p">,</span><span class="n">df_sol</span><span class="p">])</span> <span class="c1"># 3</span>
<span class="n">df_reset_sol</span> <span class="o">=</span> <span class="n">df_concat_sol</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="n">missing_feet_series_sol</span> <span class="o">=</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># 5</span>
<span class="n">with_feet_series_sol</span> <span class="o">=</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">missing_feet_series_sol</span><span class="p">,</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Metres&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">3.28084</span><span class="p">)</span> <span class="c1"># 6</span>
<span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">with_feet_series_sol</span>

<span class="n">or_df7000_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mountains_above_7000m_copy.csv&#39;</span><span class="p">,</span> <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># 1</span>
<span class="n">or_df7000_norange_sol</span> <span class="o">=</span> <span class="n">or_df7000_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Range&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 2</span>
<span class="n">or_df_concat_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_sol</span><span class="p">,</span><span class="n">or_df7000_norange_sol</span><span class="p">])</span> <span class="c1"># 3</span>
<span class="n">or_df_reset_sol</span> <span class="o">=</span> <span class="n">or_df_concat_sol</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="n">or_missing_feet_series_sol</span> <span class="o">=</span> <span class="n">or_df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># 5</span>
<span class="n">or_with_feet_series_sol</span> <span class="o">=</span> <span class="n">or_df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">or_missing_feet_series_sol</span><span class="p">,</span> <span class="n">or_df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Metres&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">3.28084</span><span class="p">)</span> <span class="c1"># 6</span>
<span class="n">or_df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">or_with_feet_series_sol</span>

<span class="k">assert</span> <span class="n">df_reset_sol</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_reset</span><span class="p">)</span> <span class="ow">or</span> <span class="n">or_df_reset_sol</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">df_reset</span><span class="p">),</span> <span class="s1">&#39;6.5.2 - Incorrect answer&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-info"><b>(Searching) Exercise 6.5.3</b><br><br><div style="text-align: justify">Now that our geologist friend has all this information, he wants to know how many of these mountains are claimed by China. Can you help him out? <i><br><br>Hint: you need to find out which elements in the appropriate column contains the string 'China'.</i></div></div><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39; write your code here, do not change any variable name &#39;&#39;&#39;</span>

<span class="c1"># you only need one line of code</span>
<span class="n">china_mountains</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">###BEGIN SOLUTION TEMPLATE=</span>
<span class="n">china_mountains</span> <span class="o">=</span> <span class="n">df_reset</span><span class="p">[</span><span class="s2">&quot;Location and Notes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="c1">###END SOLUTION</span>

<span class="nb">print</span><span class="p">(</span><span class="n">china_mountains</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###BEGIN HIDDEN TESTS</span>
<span class="n">df_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;tallest_mountains.csv&#39;</span><span class="p">)</span>

<span class="n">df7000_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;mountains_above_7000m_copy.csv&#39;</span><span class="p">,</span> <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># 1</span>
<span class="n">df7000_norange_sol</span> <span class="o">=</span> <span class="n">df7000_sol</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Range&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 2</span>
<span class="n">df_concat_sol</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df7000_norange_sol</span><span class="p">,</span><span class="n">df_sol</span><span class="p">])</span> <span class="c1"># 3</span>
<span class="n">df_reset_sol</span> <span class="o">=</span> <span class="n">df_concat_sol</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># 4</span>
<span class="n">missing_feet_series_sol</span> <span class="o">=</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># 5</span>
<span class="n">with_feet_series_sol</span> <span class="o">=</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mask</span><span class="p">(</span><span class="n">missing_feet_series_sol</span><span class="p">,</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Metres&quot;</span><span class="p">]</span><span class="o">*</span><span class="mf">3.28084</span><span class="p">)</span> <span class="c1"># 6</span>
<span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Feet&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">with_feet_series_sol</span>

<span class="n">china_mountains_sol</span> <span class="o">=</span> <span class="n">df_reset_sol</span><span class="p">[</span><span class="s2">&quot;Location and Notes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;China&quot;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">china_mountains_sol</span> <span class="o">==</span> <span class="n">china_mountains</span><span class="p">,</span> <span class="s1">&#39;6.5.3 - Incorrect answer&#39;</span>
<span class="c1">###END HIDDEN TESTS</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-danger"><b>Additional study material:</b><br><br><li><a href = "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series">Official pandas Documentation (Series)</a></li><li><a href = "https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame">Official pandas Documentation (DataFrame)</a></li><li><a href = "https://ggbaker.ca/732/content/pandas-speed.html">Note on processing speed</a></li><li><a href = "https://realpython.com/pandas-python-explore-dataset/">Real Python</a></li></div><h4>After this Notebook you should be able to:</h4>
<ul class="simple">
<li><p>understand <b><code>Series</code></b> and <b><code>DataFrames</code></b></p></li>
<li><p>concatenate <b><code>DataFrames</code></b></p></li>
<li><p>work with different labels of a <b><code>DataFrame</code></b></p></li>
<li><p>drop unwanted rows and columns</p></li>
<li><p>access and modify values within your <b><code>DataFrame</code></b></p></li>
<li><p>import data into a <b><code>pandas DataFrame</code></b></p></li>
<li><p>manipulate a <b><code>DataFrame</code></b> in several important ways</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./originals"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="PythonNotebook5.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python Notebook #5</p>
      </div>
    </a>
    <a class="right-next"
       href="installations.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Installations (MUDE)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Magic Mike!
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>